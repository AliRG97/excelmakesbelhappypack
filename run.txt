#psuedocode

	
	every_country = {	
		#so this below is some weird scope logic you can fry your brain over.
		limit = { ROOT = { knows_country = PREV } }
		# knows_country = ROOT would have been fine. but are all countries muttaly aware of each other.
		export_to_variable = {
			which = income
			value =  monthly_income
		}
		if = {limit = { tag = ROOT } 
		log = "our monthly_income is [This.income.GetValue]/month"	
		}
		export_to_variable = { #each country income
			which = percentage1
			value = trigger_value:tax_income_percentage
		}
		if = {limit = { tag = ROOT } 
			set_variable = { which = out	which = income	} 
			multiply_variable = { which = out 	which = percentage1		}
			log = "our tax_income_percentage is [This.percentage1.GetValue]x100%. Which should give us a tax income of [This.out.GetValue]/month"	
		}
		export_to_variable = {
			which = percentage4
			value = trigger_value:production_income_percentage
		}
		if = {limit = { tag = ROOT } 
		set_variable = { which = out	which = income	} 
			multiply_variable = { which = out 	which = percentage4	}
			log = "our production_income_percentage is [This.percentage4.GetValue]x100%. Which should give us a production income of [This.out.GetValue]/month"
		}
		export_to_variable = {
			which = percentage3
			value = trigger_value:trade_income_percentage
		}
		if = {limit = { tag = ROOT } 
		set_variable = { which = out	which = income	} 
			multiply_variable = { which = out 	which = percentage3	}
			log = "our trade_income_percentage is [This.percentage3.GetValue]x100%. Which should give us a trade income of [This.out.GetValue]/month"
		}`` 
		export_to_variable = {
			which = percentage2
			value = trigger_value:gold_income_percentage
		}
		if = {limit = { tag = ROOT } 
		set_variable = { which = out	which = income	} 
			multiply_variable = { which = out 	which = percentage2	}
			log = "our gold_income_percentage is [This.percentage2.GetValue]x100%. Which should give us a gold income of [This.out.GetValue]/month"
		}

		change_variable = {
			which = percentage1
			which = percentage2
		}
		change_variable = {
			which = percentage3
			which = percentage4
		}
		change_variable = {
			which = percentage1
			which = percentage3
		}
		if = {limit = { tag = ROOT } 
		log = "Summed out nations income [This.percentage1.GetValue]x100%"	
		}
		multiply_variable = {
			which = income
			which = percentage1
		}
		if = {limit = { tag = ROOT } 
		log = "our real income is therfore [This.income.GetValue]/month"	
		}
		   
	}	
	log = "Currenlty playing [This.GetName] with a real income [This.income.GetValue] ducats a month"
	every_known_country = {
		if = {
			limit = {
			calc_true_if = {
				amount = 13
			all_country = {	
					ROOT = { knows_country = PREV }
					check_variable = {
						which = income
						which = PREV
					}
			}	} 
		NOT = {
			calc_true_if = {
				amount = 14
			all_country = {	
					ROOT = { knows_country = PREV }
					check_variable = {
						which = income
						which = PREV
					}
			}	} 		
			}
		}
			log = "Number 14 is [This.GetName] with a real income of [This.income.GetValue] ducats a month"
		} 
	}


	random_known_country = {	
		limit = { has_country_flag = target }
			clr_country_flag = target
				log = "tag change to [Prev.GetName]"
				switch_tag = PREV #tag into X
	}
